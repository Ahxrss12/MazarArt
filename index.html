<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تطبيق حجز التجارب</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'arabic': ['Segoe UI', 'Tahoma', 'Arial', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Arial, sans-serif; }
        .map-container { 
            background: linear-gradient(45deg, #e8f5e8 0%, #f0f8f0 25%, #e0f0e0 50%, #d8e8d8 75%, #f5f8f5 100%);
            position: relative;
            overflow: hidden;
        }
        .map-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(34, 139, 34, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(70, 130, 180, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 70%, rgba(160, 82, 45, 0.1) 0%, transparent 50%),
                linear-gradient(90deg, rgba(105, 105, 105, 0.05) 1px, transparent 1px),
                linear-gradient(rgba(105, 105, 105, 0.05) 1px, transparent 1px);
            background-size: 100% 100%, 100% 100%, 100% 100%, 50px 50px, 50px 50px;
            pointer-events: none;
        }
        .map-roads {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }
        .road {
            position: absolute;
            background: rgba(128, 128, 128, 0.3);
            border-radius: 2px;
        }
        .road-horizontal {
            height: 4px;
            width: 100%;
        }
        .road-vertical {
            width: 4px;
            height: 100%;
        }
        .zoom-controls {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        .zoom-btn {
            width: 40px;
            height: 40px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            color: #666;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.2s;
        }
        .zoom-btn:hover {
            background: #f0f0f0;
            border-color: #999;
        }
        .experience-pin { 
            animation: pulse 2s infinite;
            cursor: pointer;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .modal-overlay {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
        .slide-up {
            animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-50 font-arabic">
    <!-- شاشة البدء -->
    <div id="startScreen" class="min-h-screen bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl shadow-2xl p-8 w-full max-w-md text-center">
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">🌟 تجارب مميزة</h1>
                <p class="text-gray-600">اكتشف أفضل التجارب في مدينتك</p>
            </div>
            
            <div class="mb-6">
                <label class="block text-right text-gray-700 mb-2">اختر اللغة</label>
                <select class="w-full p-3 border border-gray-300 rounded-xl text-right">
                    <option>العربية</option>
                    <option>English</option>
                </select>
            </div>
            
            <div class="space-y-4">
                <button onclick="showLogin()" class="w-full bg-purple-600 text-white py-3 rounded-xl font-semibold hover:bg-purple-700 transition-colors">
                    تسجيل الدخول
                </button>
                <button onclick="showRegister()" class="w-full border-2 border-purple-600 text-purple-600 py-3 rounded-xl font-semibold hover:bg-purple-50 transition-colors">
                    إنشاء حساب جديد
                </button>
                <button onclick="showMap()" class="w-full bg-gray-100 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-200 transition-colors">
                    الدخول كضيف 👤
                </button>
            </div>
        </div>
    </div>

    <!-- شاشة تسجيل الدخول -->
    <div id="loginScreen" class="hidden min-h-screen bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl shadow-2xl p-8 w-full max-w-md">
            <button onclick="showStart()" class="mb-4 text-gray-600 hover:text-gray-800">← العودة</button>
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">تسجيل الدخول</h2>
            
            <div class="space-y-4">
                <input type="email" placeholder="البريد الإلكتروني" class="w-full p-3 border border-gray-300 rounded-xl text-right">
                <input type="password" placeholder="كلمة المرور" class="w-full p-3 border border-gray-300 rounded-xl text-right">
                <button onclick="showMap()" class="w-full bg-purple-600 text-white py-3 rounded-xl font-semibold hover:bg-purple-700 transition-colors">
                    دخول
                </button>
            </div>
        </div>
    </div>

    <!-- شاشة إنشاء حساب -->
    <div id="registerScreen" class="hidden min-h-screen bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl shadow-2xl p-8 w-full max-w-md">
            <button onclick="showStart()" class="mb-4 text-gray-600 hover:text-gray-800">← العودة</button>
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">إنشاء حساب جديد</h2>
            
            <div class="space-y-4">
                <input type="text" placeholder="الاسم الكامل" class="w-full p-3 border border-gray-300 rounded-xl text-right">
                <input type="email" placeholder="البريد الإلكتروني" class="w-full p-3 border border-gray-300 rounded-xl text-right">
                <input type="password" placeholder="كلمة المرور" class="w-full p-3 border border-gray-300 rounded-xl text-right">
                <button onclick="showMap()" class="w-full bg-purple-600 text-white py-3 rounded-xl font-semibold hover:bg-purple-700 transition-colors">
                    إنشاء الحساب
                </button>
            </div>
        </div>
    </div>

    <!-- شاشة الخريطة -->
    <div id="mapScreen" class="hidden min-h-screen bg-gray-100">
        <!-- شريط البحث العلوي -->
        <div class="bg-white shadow-lg p-4">
            <div class="flex items-center space-x-4 space-x-reverse">
                <button onclick="showProfile()" class="p-2 rounded-full bg-purple-100 text-purple-600">
                    👤
                </button>
                <div class="flex-1 relative">
                    <input 
                        type="text" 
                        placeholder="ابحث عن التجارب..." 
                        class="w-full p-3 pr-12 border border-gray-300 rounded-xl text-right"
                        onclick="showFilters()"
                        readonly
                    >
                    <span class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400">🔍</span>
                </div>
            </div>
        </div>

        <!-- الخريطة -->
        <div class="map-container relative h-screen" id="mapContainer">
            <!-- أزرار التحكم في التكبير -->
            <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomIn()">+</button>
                <button class="zoom-btn" onclick="zoomOut()">-</button>
            </div>
            
            <!-- الطرق -->
            <div class="map-roads">
                <div class="road road-horizontal" style="top: 25%;"></div>
                <div class="road road-horizontal" style="top: 50%;"></div>
                <div class="road road-horizontal" style="top: 75%;"></div>
                <div class="road road-vertical" style="left: 30%;"></div>
                <div class="road road-vertical" style="left: 60%;"></div>
            </div>
            
            <!-- نقاط التجارب على الخريطة -->
            <div class="experience-pin absolute top-1/4 right-1/4 bg-red-500 text-white p-3 rounded-full shadow-lg" onclick="showExperience(1)">
                🎭
            </div>
            <div class="experience-pin absolute top-1/3 right-1/2 bg-green-500 text-white p-3 rounded-full shadow-lg" onclick="showExperience(2)">
                🍳
            </div>
            <div class="experience-pin absolute top-1/2 right-1/3 bg-blue-500 text-white p-3 rounded-full shadow-lg" onclick="showExperience(3)">
                🎨
            </div>
            <div class="experience-pin absolute top-2/3 right-2/3 bg-yellow-500 text-white p-3 rounded-full shadow-lg" onclick="showExperience(4)">
                🏃‍♂️
            </div>
            
            <!-- التجارب الثقافية والتاريخية الجديدة -->
            <div class="experience-pin absolute top-1/5 right-3/5 bg-purple-600 text-white p-3 rounded-full shadow-lg" onclick="showExperience(5)">
                🏛️
            </div>
            <div class="experience-pin absolute top-2/5 right-1/5 bg-indigo-600 text-white p-3 rounded-full shadow-lg" onclick="showExperience(6)">
                ✍️
            </div>
            <div class="experience-pin absolute top-3/5 right-4/5 bg-pink-500 text-white p-3 rounded-full shadow-lg" onclick="showExperience(7)">
                🌸
            </div>
            <div class="experience-pin absolute top-4/5 right-2/5 bg-amber-600 text-white p-3 rounded-full shadow-lg" onclick="showExperience(8)">
                🕌
            </div>
            <div class="experience-pin absolute top-1/6 right-4/6 bg-teal-600 text-white p-3 rounded-full shadow-lg" onclick="showExperience(9)">
                🏺
            </div>
            <div class="experience-pin absolute top-3/4 right-1/6 bg-cyan-600 text-white p-3 rounded-full shadow-lg" onclick="showExperience(10)">
                📸
            </div>
            <div class="experience-pin absolute top-1/8 right-5/6 bg-orange-600 text-white p-3 rounded-full shadow-lg" onclick="showExperience(11)">
                🎵
            </div>
            <div class="experience-pin absolute top-5/6 right-3/4 bg-emerald-600 text-white p-3 rounded-full shadow-lg" onclick="showExperience(12)">
                🐎
            </div>
        </div>
    </div>

    <!-- شاشة الفلاتر -->
    <div id="filtersModal" class="hidden fixed inset-0 modal-overlay z-50 flex items-end">
        <div class="bg-white rounded-t-3xl w-full max-h-3/4 overflow-y-auto slide-up">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold">فلترة التجارب</h3>
                    <button onclick="hideFilters()" class="text-gray-500 text-2xl">×</button>
                </div>
                
                <div class="space-y-6">
                    <div>
                        <label class="block text-gray-700 mb-2">نوع التجربة</label>
                        <select class="w-full p-3 border border-gray-300 rounded-xl text-right">
                            <option>جميع الأنواع</option>
                            <option>فنون وثقافة</option>
                            <option>طبخ وطعام</option>
                            <option>رياضة ومغامرة</option>
                            <option>تعليمية</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 mb-2">عدد الأشخاص</label>
                        <select class="w-full p-3 border border-gray-300 rounded-xl text-right">
                            <option>أي عدد</option>
                            <option>1-2 أشخاص</option>
                            <option>3-5 أشخاص</option>
                            <option>6+ أشخاص</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 mb-2">السعر</label>
                        <select class="w-full p-3 border border-gray-300 rounded-xl text-right">
                            <option>أي سعر</option>
                            <option>أقل من 100 ريال</option>
                            <option>100-300 ريال</option>
                            <option>أكثر من 300 ريال</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 mb-2">الوقت</label>
                        <select class="w-full p-3 border border-gray-300 rounded-xl text-right">
                            <option>أي وقت</option>
                            <option>صباحاً</option>
                            <option>بعد الظهر</option>
                            <option>مساءً</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-gray-700 mb-2">مدة التجربة</label>
                        <select class="w-full p-3 border border-gray-300 rounded-xl text-right">
                            <option>أي مدة</option>
                            <option>أقل من ساعة</option>
                            <option>1-3 ساعات</option>
                            <option>أكثر من 3 ساعات</option>
                        </select>
                    </div>
                </div>
                
                <button onclick="applyFilters()" class="w-full bg-purple-600 text-white py-3 rounded-xl font-semibold mt-6 hover:bg-purple-700 transition-colors">
                    تطبيق الفلاتر
                </button>
            </div>
        </div>
    </div>

    <!-- شاشة تفاصيل التجربة -->
    <div id="experienceModal" class="hidden fixed inset-0 modal-overlay z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl w-full max-w-md max-h-5/6 overflow-y-auto slide-up">
            <div class="relative">
                <img src="https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=400&h=200&fit=crop" alt="صورة التجربة" class="w-full h-48 object-cover rounded-t-3xl">
                <button onclick="hideExperience()" class="absolute top-4 left-4 bg-white rounded-full p-2 shadow-lg">×</button>
            </div>
            
            <div class="p-6">
                <h3 id="experienceTitle" class="text-2xl font-bold mb-4">ورشة الطبخ التقليدي</h3>
                
                <div class="mb-6">
                    <h4 class="font-semibold mb-2">المواعيد المتاحة</h4>
                    <div class="grid grid-cols-2 gap-2">
                        <button class="p-2 border border-gray-300 rounded-lg hover:bg-purple-50 hover:border-purple-300" onclick="selectDate(this)">
                            الجمعة 15/12
                        </button>
                        <button class="p-2 border border-gray-300 rounded-lg hover:bg-purple-50 hover:border-purple-300" onclick="selectDate(this)">
                            السبت 16/12
                        </button>
                        <button class="p-2 border border-gray-300 rounded-lg hover:bg-purple-50 hover:border-purple-300" onclick="selectDate(this)">
                            الأحد 17/12
                        </button>
                        <button class="p-2 border border-gray-300 rounded-lg hover:bg-purple-50 hover:border-purple-300" onclick="selectDate(this)">
                            الاثنين 18/12
                        </button>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h4 class="font-semibold mb-2">عدد الأشخاص</h4>
                    <div class="flex items-center justify-center space-x-4 space-x-reverse">
                        <button onclick="decreaseCount()" class="bg-gray-200 rounded-full w-10 h-10 flex items-center justify-center">-</button>
                        <span id="personCount" class="text-xl font-semibold">2</span>
                        <button onclick="increaseCount()" class="bg-gray-200 rounded-full w-10 h-10 flex items-center justify-center">+</button>
                    </div>
                </div>
                
                <div class="mb-6">
                    <div class="flex justify-between items-center">
                        <span class="text-2xl font-bold text-purple-600" id="totalPrice">200 ريال</span>
                        <span class="text-gray-600">السعر الإجمالي</span>
                    </div>
                </div>
                
                <button onclick="showPayment()" class="w-full bg-purple-600 text-white py-3 rounded-xl font-semibold hover:bg-purple-700 transition-colors">
                    احجز الآن
                </button>
            </div>
        </div>
    </div>

    <!-- شاشة الدفع -->
    <div id="paymentScreen" class="hidden min-h-screen bg-gray-50 p-4">
        <div class="max-w-md mx-auto">
            <div class="bg-white rounded-3xl shadow-lg p-6 mb-4">
                <button onclick="hidePayment()" class="mb-4 text-gray-600 hover:text-gray-800">← العودة</button>
                <h2 class="text-2xl font-bold mb-6 text-center">ملخص الحجز</h2>
                
                <div class="space-y-4 mb-6">
                    <div class="flex justify-between">
                        <span class="font-semibold">ورشة الطبخ التقليدي</span>
                        <span>التجربة</span>
                    </div>
                    <div class="flex justify-between">
                        <span>الجمعة 15/12 - 3:00 م</span>
                        <span>التاريخ والوقت</span>
                    </div>
                    <div class="flex justify-between">
                        <span>2 أشخاص</span>
                        <span>العدد</span>
                    </div>
                    <hr>
                    <div class="flex justify-between font-bold text-lg">
                        <span class="text-purple-600">200 ريال</span>
                        <span>المجموع</span>
                    </div>
                </div>
                
                <button onclick="showConfirmation()" class="w-full bg-purple-600 text-white py-3 rounded-xl font-semibold hover:bg-purple-700 transition-colors">
                    إتمام الدفع
                </button>
            </div>
        </div>
    </div>

    <!-- شاشة تأكيد الحجز -->
    <div id="confirmationScreen" class="hidden min-h-screen bg-gradient-to-br from-green-400 to-blue-500 flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl shadow-2xl p-8 w-full max-w-md text-center">
            <div class="text-6xl mb-4">✅</div>
            <h2 class="text-2xl font-bold text-gray-800 mb-4">تم تأكيد الحجز!</h2>
            <p class="text-gray-600 mb-4">حجزك مؤقت وغير محفوظ</p>
            
            <!-- QR Code الحجز -->
            <div class="bg-gray-50 rounded-2xl p-6 mb-6">
                <h3 class="font-bold text-gray-800 mb-3">QR Code الحجز</h3>
                <div class="bg-white p-4 rounded-xl border-2 border-dashed border-gray-300 mb-3">
                    <canvas id="barcodeCanvas" class="mx-auto"></canvas>
                </div>
                <p class="text-sm text-gray-600 mb-2">رقم الحجز: <span id="bookingNumber" class="font-mono font-bold"></span></p>
                <p class="text-xs text-gray-500">امسح هذا الرمز عند الوصول للتجربة</p>
                <button onclick="downloadBarcode()" class="mt-3 bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700">
                    تحميل QR Code 📱
                </button>
            </div>
            
            <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-3 mb-6">
                <p class="text-yellow-700 text-sm">💡 سجل دخولك لحفظ الحجز بشكل دائم</p>
            </div>
            
            <div class="space-y-3">
                <button onclick="showLogin()" class="w-full bg-purple-600 text-white py-3 rounded-xl font-semibold hover:bg-purple-700 transition-colors">
                    تسجيل الدخول لحفظ الحجز
                </button>
                <button onclick="showMap()" class="w-full border border-gray-300 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-50 transition-colors">
                    المتابعة كضيف
                </button>
            </div>
        </div>
    </div>

    <!-- شاشة المستخدم -->
    <div id="profileScreen" class="hidden min-h-screen bg-gray-50">
        <div class="bg-white shadow-lg p-4 mb-4">
            <div class="flex items-center justify-between">
                <h2 class="text-xl font-bold">حسابي</h2>
                <button onclick="showMap()" class="text-gray-600 hover:text-gray-800">← العودة</button>
            </div>
        </div>
        
        <div class="max-w-md mx-auto p-4 space-y-4">
            <div class="bg-white rounded-2xl shadow-lg p-6 text-center">
                <div class="w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-3xl">👤</span>
                </div>
                <h3 class="text-xl font-bold mb-2">ضيف</h3>
                <p class="text-gray-600">غير مسجل</p>
                <button onclick="showLogin()" class="mt-3 bg-purple-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-purple-700">
                    تسجيل الدخول للحفظ
                </button>
            </div>
            
            <div class="space-y-3">
                <button onclick="showGuestBookings()" class="w-full bg-white rounded-2xl shadow-lg p-4 flex items-center justify-between hover:bg-gray-50">
                    <span>→</span>
                    <div class="text-right">
                        <div class="font-semibold">حجوزاتي المؤقتة</div>
                        <div class="text-sm text-gray-600">غير محفوظة</div>
                    </div>
                    <span class="text-2xl">📅</span>
                </button>
                
                <button onclick="showLogin()" class="w-full bg-purple-50 rounded-2xl shadow-lg p-4 flex items-center justify-between hover:bg-purple-100 text-purple-600">
                    <span>→</span>
                    <div class="text-right">
                        <div class="font-semibold">إنشاء حساب</div>
                        <div class="text-sm text-purple-500">لحفظ الحجوزات</div>
                    </div>
                    <span class="text-2xl">✨</span>
                </button>
                
                <button class="w-full bg-white rounded-2xl shadow-lg p-4 flex items-center justify-between hover:bg-gray-50">
                    <span>→</span>
                    <div class="text-right">
                        <div class="font-semibold">الإعدادات</div>
                    </div>
                    <span class="text-2xl">⚙️</span>
                </button>
            </div>
        </div>
    </div>

    <!-- شاشة التجارب القادمة -->
    <div id="upcomingBookingsScreen" class="hidden min-h-screen bg-gray-50">
        <div class="bg-white shadow-lg p-4 mb-4">
            <div class="flex items-center justify-between">
                <h2 class="text-xl font-bold">تجاربي القادمة</h2>
                <button onclick="showProfile()" class="text-gray-600 hover:text-gray-800">← العودة</button>
            </div>
        </div>
        
        <div class="max-w-md mx-auto p-4 space-y-4">
            <div class="bg-white rounded-2xl shadow-lg p-4">
                <div class="flex justify-between items-start mb-3">
                    <div class="text-right">
                        <h3 class="font-bold">ورشة الطبخ التقليدي</h3>
                        <p class="text-gray-600 text-sm">الجمعة 15/12 - 3:00 م</p>
                        <p class="text-purple-600 font-semibold">200 ريال</p>
                    </div>
                    <span class="text-2xl">🍳</span>
                </div>
                <div class="flex space-x-2 space-x-reverse">
                    <button class="flex-1 bg-purple-600 text-white py-2 rounded-lg text-sm hover:bg-purple-700">
                        تعديل
                    </button>
                    <button class="flex-1 bg-red-600 text-white py-2 rounded-lg text-sm hover:bg-red-700">
                        إلغاء
                    </button>
                </div>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-4">
                <div class="flex justify-between items-start mb-3">
                    <div class="text-right">
                        <h3 class="font-bold">ورشة الرسم المائي</h3>
                        <p class="text-gray-600 text-sm">السبت 23/12 - 10:00 ص</p>
                        <p class="text-purple-600 font-semibold">150 ريال</p>
                    </div>
                    <span class="text-2xl">🎨</span>
                </div>
                <div class="flex space-x-2 space-x-reverse">
                    <button class="flex-1 bg-purple-600 text-white py-2 rounded-lg text-sm hover:bg-purple-700">
                        تعديل
                    </button>
                    <button class="flex-1 bg-red-600 text-white py-2 rounded-lg text-sm hover:bg-red-700">
                        إلغاء
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- شاشة حجوزات الضيف -->
    <div id="guestBookingsScreen" class="hidden min-h-screen bg-gray-50">
        <div class="bg-white shadow-lg p-4 mb-4">
            <div class="flex items-center justify-between">
                <h2 class="text-xl font-bold">حجوزاتي المؤقتة</h2>
                <button onclick="showProfile()" class="text-gray-600 hover:text-gray-800">← العودة</button>
            </div>
        </div>
        
        <div class="max-w-md mx-auto p-4">
            <div class="bg-yellow-50 border border-yellow-200 rounded-2xl p-4 mb-4">
                <div class="flex items-center mb-2">
                    <span class="text-yellow-600 text-xl ml-2">⚠️</span>
                    <span class="font-semibold text-yellow-800">تنبيه</span>
                </div>
                <p class="text-yellow-700 text-sm">
                    حجوزاتك غير محفوظة. سجل دخولك أو أنشئ حساباً لحفظ حجوزاتك بشكل دائم.
                </p>
                <button onclick="showLogin()" class="mt-3 bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-yellow-700">
                    تسجيل الدخول الآن
                </button>
            </div>
            
            <div id="guestBookingsList" class="space-y-4">
                <!-- ستظهر الحجوزات المؤقتة هنا -->
                <div class="text-center text-gray-500 py-8">
                    <span class="text-4xl block mb-2">📝</span>
                    <p>لا توجد حجوزات مؤقتة</p>
                </div>
            </div>
        </div>
    </div>

    <!-- شاشة التجارب السابقة -->
    <div id="pastBookingsScreen" class="hidden min-h-screen bg-gray-50">
        <div class="bg-white shadow-lg p-4 mb-4">
            <div class="flex items-center justify-between">
                <h2 class="text-xl font-bold">تجاربي السابقة</h2>
                <button onclick="showProfile()" class="text-gray-600 hover:text-gray-800">← العودة</button>
            </div>
        </div>
        
        <div class="max-w-md mx-auto p-4 space-y-4">
            <div class="bg-white rounded-2xl shadow-lg p-4">
                <div class="flex justify-between items-start mb-3">
                    <div class="text-right">
                        <h3 class="font-bold">ورشة صناعة الفخار</h3>
                        <p class="text-gray-600 text-sm">الجمعة 1/12 - 2:00 م</p>
                        <p class="text-gray-500">مكتملة ✅</p>
                    </div>
                    <span class="text-2xl">🏺</span>
                </div>
                <button class="w-full bg-yellow-500 text-white py-2 rounded-lg text-sm hover:bg-yellow-600">
                    تقييم التجربة ⭐
                </button>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-4">
                <div class="flex justify-between items-start mb-3">
                    <div class="text-right">
                        <h3 class="font-bold">جولة تصوير فوتوغرافي</h3>
                        <p class="text-gray-600 text-sm">السبت 25/11 - 6:00 ص</p>
                        <p class="text-gray-500">مكتملة ✅</p>
                    </div>
                    <span class="text-2xl">📸</span>
                </div>
                <div class="flex items-center justify-between">
                    <div class="text-yellow-500">⭐⭐⭐⭐⭐</div>
                    <span class="text-sm text-gray-600">تم التقييم</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentPersonCount = 2;
        let selectedDate = null;
        let currentExperience = null;
        let mapZoom = 1;
        let mapPanX = 0;
        let mapPanY = 0;

        const experiences = {
            1: { title: "ورشة المسرح التفاعلي", price: 180, icon: "🎭", category: "فنون وثقافة" },
            2: { title: "ورشة الطبخ التقليدي", price: 100, icon: "🍳", category: "طبخ وطعام" },
            3: { title: "ورشة الرسم المائي", price: 120, icon: "🎨", category: "فنون وثقافة" },
            4: { title: "تجربة الجري الصباحي", price: 80, icon: "🏃‍♂️", category: "رياضة ومغامرة" },
            5: { title: "جولة في المتحف الوطني", price: 50, icon: "🏛️", category: "ثقافية وتاريخية" },
            6: { title: "ورشة الخط العربي", price: 90, icon: "✍️", category: "ثقافية وتاريخية" },
            7: { title: "تجربة صناعة العطور", price: 200, icon: "🌸", category: "تعليمية" },
            8: { title: "جولة في البلدة القديمة", price: 60, icon: "🕌", category: "ثقافية وتاريخية" },
            9: { title: "ورشة صناعة الفخار", price: 140, icon: "🏺", category: "فنون وثقافة" },
            10: { title: "تجربة التصوير الفوتوغرافي", price: 160, icon: "📸", category: "تعليمية" },
            11: { title: "ورشة الموسيقى التراثية", price: 110, icon: "🎵", category: "ثقافية وتاريخية" },
            12: { title: "تجربة ركوب الخيل", price: 250, icon: "🐎", category: "رياضة ومغامرة" }
        };

        function showScreen(screenId) {
            document.querySelectorAll('[id$="Screen"], [id$="Modal"]').forEach(el => {
                el.classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
            document.getElementById(screenId).classList.add('fade-in');
        }

        function showStart() { showScreen('startScreen'); }
        function showLogin() { showScreen('loginScreen'); }
        function showRegister() { showScreen('registerScreen'); }
        function showMap() { showScreen('mapScreen'); }
        function showProfile() { showScreen('profileScreen'); }
        function showUpcomingBookings() { showScreen('upcomingBookingsScreen'); }
        function showPastBookings() { showScreen('pastBookingsScreen'); }
        function showGuestBookings() { showScreen('guestBookingsScreen'); }

        function showFilters() {
            document.getElementById('filtersModal').classList.remove('hidden');
        }

        function hideFilters() {
            document.getElementById('filtersModal').classList.add('hidden');
        }

        function applyFilters() {
            hideFilters();
            // هنا يمكن إضافة منطق تطبيق الفلاتر
        }

        function showExperience(id) {
            currentExperience = experiences[id];
            document.getElementById('experienceTitle').textContent = currentExperience.title;
            updateTotalPrice();
            document.getElementById('experienceModal').classList.remove('hidden');
        }

        function hideExperience() {
            document.getElementById('experienceModal').classList.add('hidden');
        }

        function selectDate(button) {
            document.querySelectorAll('#experienceModal button').forEach(btn => {
                btn.classList.remove('bg-purple-100', 'border-purple-300');
            });
            button.classList.add('bg-purple-100', 'border-purple-300');
            selectedDate = button.textContent;
        }

        function increaseCount() {
            if (currentPersonCount < 10) {
                currentPersonCount++;
                document.getElementById('personCount').textContent = currentPersonCount;
                updateTotalPrice();
            }
        }

        function decreaseCount() {
            if (currentPersonCount > 1) {
                currentPersonCount--;
                document.getElementById('personCount').textContent = currentPersonCount;
                updateTotalPrice();
            }
        }

        function updateTotalPrice() {
            if (currentExperience) {
                const total = currentExperience.price * currentPersonCount;
                document.getElementById('totalPrice').textContent = total + ' ريال';
            }
        }

        function showPayment() {
            if (!selectedDate) {
                alert('يرجى اختيار التاريخ أولاً');
                return;
            }
            hideExperience();
            showScreen('paymentScreen');
        }

        function hidePayment() {
            showScreen('mapScreen');
        }

        function showConfirmation() {
            generateBookingNumber();
            generateBarcode();
            showScreen('confirmationScreen');
        }

        function generateBookingNumber() {
            // توليد رقم حجز فريد
            const timestamp = Date.now();
            const random = Math.floor(Math.random() * 1000);
            const bookingNumber = 'EXP' + timestamp.toString().slice(-6) + random.toString().padStart(3, '0');
            document.getElementById('bookingNumber').textContent = bookingNumber;
            return bookingNumber;
        }

        function generateBarcode() {
            const canvas = document.getElementById('barcodeCanvas');
            const ctx = canvas.getContext('2d');
            const bookingNumber = document.getElementById('bookingNumber').textContent;
            
            // تحديد حجم الكانفاس للـ QR Code
            canvas.width = 160;
            canvas.height = 160;
            
            // مسح الكانفاس
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // إنشاء QR Code بسيط
            const qrSize = 20; // 20x20 مربعات
            const cellSize = 6; // حجم كل مربع
            const padding = 20;
            
            // توليد نمط QR Code بناءً على رقم الحجز
            const qrData = generateQRPattern(bookingNumber);
            
            ctx.fillStyle = 'black';
            
            // رسم المربعات
            for (let row = 0; row < qrSize; row++) {
                for (let col = 0; col < qrSize; col++) {
                    if (qrData[row][col]) {
                        const x = padding + col * cellSize;
                        const y = padding + row * cellSize;
                        ctx.fillRect(x, y, cellSize, cellSize);
                    }
                }
            }
            
            // رسم المربعات الثلاثة الكبيرة في الزوايا (نمط QR Code المميز)
            drawFinderPattern(ctx, padding, padding, cellSize);
            drawFinderPattern(ctx, padding + 13 * cellSize, padding, cellSize);
            drawFinderPattern(ctx, padding, padding + 13 * cellSize, cellSize);
        }
        
        function generateQRPattern(data) {
            const size = 20;
            const pattern = Array(size).fill().map(() => Array(size).fill(false));
            
            // توليد نمط عشوائي بناءً على البيانات
            let seed = 0;
            for (let i = 0; i < data.length; i++) {
                seed += data.charCodeAt(i);
            }
            
            // ملء النمط
            for (let row = 0; row < size; row++) {
                for (let col = 0; col < size; col++) {
                    // تجنب مناطق المربعات الكبيرة
                    if ((row < 7 && col < 7) || 
                        (row < 7 && col > 12) || 
                        (row > 12 && col < 7)) {
                        continue;
                    }
                    
                    const hash = (row * 31 + col * 17 + seed) % 100;
                    pattern[row][col] = hash < 50;
                }
            }
            
            return pattern;
        }
        
        function drawFinderPattern(ctx, x, y, cellSize) {
            // المربع الخارجي (7x7)
            ctx.fillRect(x, y, 7 * cellSize, 7 * cellSize);
            
            // المربع الأبيض الداخلي (5x5)
            ctx.fillStyle = 'white';
            ctx.fillRect(x + cellSize, y + cellSize, 5 * cellSize, 5 * cellSize);
            
            // المربع الأسود الداخلي (3x3)
            ctx.fillStyle = 'black';
            ctx.fillRect(x + 2 * cellSize, y + 2 * cellSize, 3 * cellSize, 3 * cellSize);
        }

        function downloadBarcode() {
            const canvas = document.getElementById('barcodeCanvas');
            const bookingNumber = document.getElementById('bookingNumber').textContent;
            
            // إنشاء رابط تحميل
            const link = document.createElement('a');
            link.download = 'booking-qrcode-' + bookingNumber + '.png';
            link.href = canvas.toDataURL();
            
            // تحميل الصورة
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function zoomIn() {
            if (mapZoom < 3) {
                mapZoom += 0.2;
                updateMapTransform();
            }
        }

        function zoomOut() {
            if (mapZoom > 0.5) {
                mapZoom -= 0.2;
                updateMapTransform();
            }
        }

        function updateMapTransform() {
            const mapContainer = document.getElementById('mapContainer');
            const pins = mapContainer.querySelectorAll('.experience-pin');
            const roads = mapContainer.querySelector('.map-roads');
            
            pins.forEach(pin => {
                pin.style.transform = `scale(${mapZoom}) translate(${mapPanX}px, ${mapPanY}px)`;
            });
            
            if (roads) {
                roads.style.transform = `scale(${mapZoom}) translate(${mapPanX}px, ${mapPanY}px)`;
            }
        }

        // تهيئة التطبيق
        document.addEventListener('DOMContentLoaded', function() {
            showStart();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96c32489860cbadc',t:'MTc1NDY5OTQwMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
